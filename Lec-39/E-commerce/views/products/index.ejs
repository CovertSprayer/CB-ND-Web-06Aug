<% layout('layouts/boilerplate.ejs') -%>
<%- include('../partials/flash') %>

    <section class="d-flex flex-wrap justify-content-center">
        <% for( let product of products ) { %>
            <div class="card mx-2 mb-3" style="width: 18rem;">
                <img class="card-img-top object-fit-cover" height="200px" src="<%= product.image %>" alt="...">
                <span class="badge text-bg-light position-absolute " style="top:38%; left:5%">
                    <%= product.avgRating %> &star; | <%= product.reviews.length %>
                </span>
                <div class="card-body">
                  <div class="d-flex justify-content-between">
                    <h5 class="card-title"><%= product.name %></h5>
                    <% if (currentUser && currentUser.wishList.includes(product._id)) { %>
                        <span><i product-id="<%= product._id %>" class="like-btn fa-solid fa-heart"></i></span>
                    <% } else { %>
                        <span><i product-id="<%= product._id %>" class="like-btn fa-regular fa-heart"></i></span>
                    <% } %>
                  </div>
                  <h5 class="card-title">$ <%= product.price %></h5>
                  <p class="card-text"><%= product.desc %></p>
                  <a href="/products/<%= product._id %>" class="btn btn-primary btn-sm">Show</a>
                </div>
            </div>
        <% } %>
    </section>

    <script src="/js/like.js"></script>
